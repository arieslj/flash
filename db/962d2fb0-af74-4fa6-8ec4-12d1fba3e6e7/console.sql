select
    min(pi.p_date) min_date
    ,max(pi.p_date) max_date
from
    (
        select
            pi.pno
            ,pi.p_date
        from fle_dwd.dwd_fle_parcel_info_di pi
        where
            pi.p_date in ('2023-01-04','2022-06-24','2022-08-16','2022-12-18','2022-10-12','2022-10-12','2022-09-09','2022-12-30','2022-12-21','2022-08-27','2022-09-20','2022-10-17','2023-01-08','2022-12-13','2022-12-13','2023-01-19','2023-01-20','2023-01-11','2022-12-16','2023-01-15','2022-12-16','2023-01-09','2023-01-09','2022-12-28','2023-01-22','2023-01-07','2022-08-25','2022-08-25','2022-06-16','2022-11-11','2022-12-23','2022-12-23','2023-01-24','2022-12-15','2022-11-05','2022-12-15','2022-12-10','2023-01-03','2022-11-23','2023-01-03','2022-12-19','2022-12-19','2022-12-02')
    ) pi
join test.tmp_ph_m_pno_0630 t on t.pno = pi.pno
;

select
    pi.pno
    ,`if`(pi.client_id in ('AA0051', 'AA0080', 'AA0050', 'AA0121', 'AA0139', oi.insure_declare_value/100, oi.cogs_amount/100)) `物品价值`
from
    (
        select
            t.pno
            ,pi,pi.client_id
            ,if(pi.returned = 0, pi.pno, pi.customary_pno) real_pno
        from
            (
                select
                    pi.pno
                    ,pi.p_date
                    ,pi.returned
                    ,pi.customary_pno
                    ,pi.client_id
                from fle_dwd.dwd_fle_parcel_info_di pi
                where
                    pi.p_date in ('2023-01-04','2022-06-24','2022-08-16','2022-12-18','2022-10-12','2022-10-12','2022-09-09','2022-12-30','2022-12-21','2022-08-27','2022-09-20','2022-10-17','2023-01-08','2022-12-13','2022-12-13','2023-01-19','2023-01-20','2023-01-11','2022-12-16','2023-01-15','2022-12-16','2023-01-09','2023-01-09','2022-12-28','2023-01-22','2023-01-07','2022-08-25','2022-08-25','2022-06-16','2022-11-11','2022-12-23','2022-12-23','2023-01-24','2022-12-15','2022-11-05','2022-12-15','2022-12-10','2023-01-03','2022-11-23','2023-01-03','2022-12-19','2022-12-19','2022-12-02')
            ) pi
        join test.tmp_ph_m_pno_0630 t on t.pno = pi.pno
    ) pi
left join
    (
        select
            oi.pno
            ,oi.insure_declare_value
            ,oi.cogs_amount
        from fle_dwd.dwd_fle_order_info_di oi
        where
            oi.p_date >= '2022-04-01'
            and oi.p_date <= '2023-01-24'
    ) oi on pi.real_pno = oi.pno